(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13062,        430]
NotebookOptionsPosition[     11554,        371]
NotebookOutlinePosition[     11905,        387]
CellTagsIndexPosition[     11862,        384]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "[", "T_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"S0", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r", "-", "q"}], ")"}], "T"}]]}], "-", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"t", "=", "0"}], "T"], 
     RowBox[{
      RowBox[{"Di", "[", "t", "]"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r", "-", "q"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"T", "-", "t"}], ")"}]}]]}]}]}], " ", "/.", " ", 
   RowBox[{"q", "\[Rule]", "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "[", "t_", "]"}], ":=", 
  RowBox[{"L0", " ", 
   SuperscriptBox["gammaL", 
    RowBox[{"-", "t"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Num", "[", "t_", "]"}], ":=", 
  RowBox[{"Num0", " ", 
   SuperscriptBox["gammaN", "t"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Di", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"L", "[", "t", "]"}], 
   RowBox[{"Lam", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lam", "[", "t_", "]"}], ":=", 
  RowBox[{"etaN", 
   FractionBox[
    RowBox[{"Fs", "[", 
     RowBox[{"Num", "[", "t", "]"}], "]"}], 
    RowBox[{"Num", "[", "t", "]"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S0", "=", 
   RowBox[{"L0", " ", 
    RowBox[{"Lam", "[", 
     RowBox[{"Num", "[", "T", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eta", "[", "n_", "]"}], ":=", 
  FractionBox["n", 
   RowBox[{"Fs", "[", "n", "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Di", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"L", "[", "t", "]"}], 
   RowBox[{"Lam", "[", "t", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7057134741862392`*^9, 3.705713609029828*^9}, {
  3.705713645808079*^9, 3.7057136708549757`*^9}, {3.705713725033902*^9, 
  3.705713845607815*^9}, {3.7057139141600933`*^9, 3.705713948685041*^9}, {
  3.7057139943270683`*^9, 3.705713994597883*^9}, {3.705714036799871*^9, 
  3.70571404974089*^9}, {3.705714158428625*^9, 3.705714172958029*^9}, {
  3.7057142486423264`*^9, 3.705714249112363*^9}, {3.705714354652608*^9, 
  3.705714356149309*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F", "[", "T", "]"}]], "Input",
 CellChangeTimes->{{3.705713611289467*^9, 3.705713624890274*^9}, {
  3.7057136754429007`*^9, 3.705713678670919*^9}, {3.70571374459426*^9, 
  3.705713745726523*^9}, {3.7057138103649893`*^9, 3.7057138130338507`*^9}, {
  3.705713848355196*^9, 3.7057138490361958`*^9}, {3.705713952071212*^9, 
  3.7057139526765423`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"r", " ", "T"}]], " ", "etaN", " ", 
    SuperscriptBox["gammaN", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["gammaN", "T"]}], " ", "Num0"}]], " ", "L0", " ", 
    RowBox[{"Fs", "[", 
     RowBox[{
      SuperscriptBox["gammaN", 
       RowBox[{
        SuperscriptBox["gammaN", "T"], " ", "Num0"}]], " ", "Num0"}], "]"}]}],
    "Num0"], "-", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"t", "=", "0"}], "T"], 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "t"}], "+", "T"}], ")"}]}]], " ", "etaN", " ", 
     SuperscriptBox["gammaL", 
      RowBox[{"-", "t"}]], " ", 
     SuperscriptBox["gammaN", 
      RowBox[{"-", "t"}]], " ", "L0", " ", 
     RowBox[{"Fs", "[", 
      RowBox[{
       SuperscriptBox["gammaN", "t"], " ", "Num0"}], "]"}]}], 
    "Num0"]}]}]], "Output",
 CellChangeTimes->{{3.705713613535029*^9, 3.705713622591556*^9}, 
   3.7057136790686407`*^9, 3.7057137461968327`*^9, {3.705713803503928*^9, 
   3.705713813918606*^9}, {3.705713849916236*^9, 3.7057138612269173`*^9}, 
   3.705713953156631*^9, {3.705714357937333*^9, 3.705714370198419*^9}, 
   3.705715389851763*^9, {3.70571889006061*^9, 3.705718902126103*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"L", "[", "t", "]"}]], "Input",
 CellChangeTimes->{{3.705713956645994*^9, 3.705713957006564*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["gammaL", 
   RowBox[{"-", "t"}]], " ", "L0"}]], "Output",
 CellChangeTimes->{3.7057139573996153`*^9, 3.705714370260178*^9, 
  3.705715390919504*^9, 3.705718903472578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Num", "[", "t", "]"}]], "Input",
 CellChangeTimes->{{3.705713960461211*^9, 3.705713960747466*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["gammaN", "t"], " ", "Num0"}]], "Output",
 CellChangeTimes->{3.7057139611400013`*^9, 3.705714370321177*^9, 
  3.705715391902362*^9, 3.705718904425943*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Lam", "[", "t", "]"}]], "Input",
 CellChangeTimes->{{3.705713963529829*^9, 3.705713963816435*^9}, {
  3.705714128499776*^9, 3.705714128767964*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"etaN", " ", 
   SuperscriptBox["gammaN", 
    RowBox[{"-", "t"}]], " ", 
   RowBox[{"Fs", "[", 
    RowBox[{
     SuperscriptBox["gammaN", "t"], " ", "Num0"}], "]"}]}], "Num0"]], "Output",\

 CellChangeTimes->{3.705713964204022*^9, 3.705714052756621*^9, 
  3.705714129300226*^9, 3.7057143703886137`*^9, 3.705715392752995*^9, 
  3.705718906960548*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Di", "[", "t", "]"}]], "Input",
 CellChangeTimes->{{3.70571396853347*^9, 3.705713968852057*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"etaN", " ", 
   SuperscriptBox["gammaL", 
    RowBox[{"-", "t"}]], " ", 
   SuperscriptBox["gammaN", 
    RowBox[{"-", "t"}]], " ", "L0", " ", 
   RowBox[{"Fs", "[", 
    RowBox[{
     SuperscriptBox["gammaN", "t"], " ", "Num0"}], "]"}]}], "Num0"]], "Output",\

 CellChangeTimes->{3.705713969256589*^9, 3.705714370454707*^9, 
  3.705715393661832*^9, 3.7057189081386347`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["S0"], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"etaN", " ", 
   SuperscriptBox["gammaN", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["gammaN", "T"]}], " ", "Num0"}]], " ", "L0", " ", 
   RowBox[{"Fs", "[", 
    RowBox[{
     SuperscriptBox["gammaN", 
      RowBox[{
       SuperscriptBox["gammaN", "T"], " ", "Num0"}]], " ", "Num0"}], "]"}]}], 
  "Num0"]], "Output",
 CellChangeTimes->{{3.7057139708950357`*^9, 3.7057139990757217`*^9}, 
   3.705714370522641*^9, 3.705715394635936*^9, 3.705718909474186*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eta", "[", "n", "]"}]], "Input",
 CellChangeTimes->{{3.705714178001355*^9, 3.7057141795574903`*^9}}],

Cell[BoxData[
 FractionBox["n", 
  RowBox[{"Fs", "[", "n", "]"}]]], "Output",
 CellChangeTimes->{3.705714180028204*^9, 3.705714370588148*^9, 
  3.70571539726362*^9, 3.7057189116332827`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Di", "[", "t", "]"}]], "Input",
 CellChangeTimes->{{3.705714199342327*^9, 3.7057142035987453`*^9}, {
  3.705714235463497*^9, 3.7057142461610107`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"etaN", " ", 
   SuperscriptBox["gammaL", 
    RowBox[{"-", "t"}]], " ", 
   SuperscriptBox["gammaN", 
    RowBox[{"-", "t"}]], " ", "L0", " ", 
   RowBox[{"Fs", "[", 
    RowBox[{
     SuperscriptBox["gammaN", "t"], " ", "Num0"}], "]"}]}], "Num0"]], "Output",\

 CellChangeTimes->{3.7057142040496798`*^9, 3.705714252974786*^9, 
  3.705714370651984*^9, 3.705718913274105*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fs", "[", "n_", "]"}], ":=", 
  RowBox[{"\[Alpha]", " ", "n"}]}]], "Input",
 CellChangeTimes->{{3.7057144572297792`*^9, 3.7057144599463787`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F", "[", "T", "]"}]], "Input",
 CellChangeTimes->{{3.7057143752714577`*^9, 3.7057143958758507`*^9}, {
  3.705714454770104*^9, 3.7057144646412783`*^9}, {3.705715299811199*^9, 
  3.705715301780992*^9}, {3.705716149404882*^9, 3.705716152462389*^9}, {
  3.7057163344310703`*^9, 3.705716345354803*^9}, {3.705718944673547*^9, 
  3.705718951588991*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"r", " ", "T"}]], " ", "etaN", " ", "L0", " ", "\[Alpha]"}], "+", 
  
  FractionBox[
   RowBox[{"etaN", " ", 
    SuperscriptBox["gammaL", 
     RowBox[{"-", "T"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"r", "+", 
         RowBox[{"r", " ", "T"}]}]], " ", 
       SuperscriptBox["gammaL", 
        RowBox[{"1", "+", "T"}]]}]}], ")"}], " ", "L0", " ", "\[Alpha]"}], 
   RowBox[{"1", "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "r"], " ", "gammaL"}]}]]}]], "Output",
 CellChangeTimes->{
  3.705714465093766*^9, {3.705715276651528*^9, 3.705715302135436*^9}, 
   3.705715400173053*^9, 3.7057154526963797`*^9, {3.70571613927008*^9, 
   3.7057161528031063`*^9}, 3.705716263198386*^9, {3.705716336582432*^9, 
   3.705716345740851*^9}, 3.7057189202276163`*^9, 3.705718952322575*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Sum", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["gN", 
       RowBox[{"gL", " ", "e"}]], ")"}], "t"], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.705716964936542*^9, 3.7057169951821747`*^9}, {
  3.705717358083939*^9, 3.7057173847447453`*^9}, {3.705717615228551*^9, 
  3.705717657225813*^9}, {3.7057178148808002`*^9, 3.705717819653954*^9}, {
  3.7057179349237127`*^9, 3.70571793546754*^9}, {3.7057180410914593`*^9, 
  3.705718068952799*^9}, {3.705719161967277*^9, 3.705719170768022*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "e"}], " ", "gL"}], "+", 
   RowBox[{"gN", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["gN", 
       RowBox[{"e", " ", "gL"}]], ")"}], "T"]}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", "e"}], " ", "gL"}], "+", "gN"}]]], "Output",
 CellChangeTimes->{{3.7057173643970747`*^9, 3.705717385143462*^9}, {
   3.705717616354632*^9, 3.7057176577977457`*^9}, 3.705717825313407*^9, 
   3.705717936195094*^9, {3.705718048391149*^9, 3.7057180693435097`*^9}, 
   3.705719171377809*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"1", "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"gL", " ", "e"}], ")"}], 
      RowBox[{"-", "t"}]], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.705718525154448*^9, 3.705718540015943*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"e", " ", "gL"}], ")"}], 
    RowBox[{"-", "T"}]]}], 
  RowBox[{"1", "-", 
   RowBox[{"e", " ", "gL"}]}]]], "Output",
 CellChangeTimes->{{3.705718535287117*^9, 3.705718540586361*^9}}]
}, Open  ]]
},
WindowSize->{808, 752},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2232, 64, 227, "Input"],
Cell[CellGroupData[{
Cell[2815, 88, 371, 6, 28, "Input"],
Cell[3189, 96, 1371, 38, 109, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4597, 139, 120, 2, 28, "Input"],
Cell[4720, 143, 212, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4969, 153, 122, 2, 28, "Input"],
Cell[5094, 157, 195, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5326, 166, 171, 3, 28, "Input"],
Cell[5500, 171, 389, 11, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5926, 187, 120, 2, 28, "Input"],
Cell[6049, 191, 413, 12, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6499, 208, 28, 0, 28, "Input"],
Cell[6530, 210, 507, 14, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7074, 229, 124, 2, 28, "Input"],
Cell[7201, 233, 189, 4, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7427, 242, 174, 3, 28, "Input"],
Cell[7604, 247, 413, 12, 52, "Output"]
}, Open  ]],
Cell[8032, 262, 180, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[8237, 270, 370, 6, 28, "Input"],
Cell[8610, 278, 979, 26, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9626, 309, 650, 14, 50, "Input"],
Cell[10279, 325, 559, 16, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10875, 346, 378, 11, 35, "Input"],
Cell[11256, 359, 282, 9, 52, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
